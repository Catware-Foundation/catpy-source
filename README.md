# catpy-source
исходные коды vk.com/catpy (слабонервным не смотреть)

## важные пометки
1) разработка этого ужаса была завершена в 2021 году, разработкой занимались агрик и Я
2) токены от различных сервисов тупо разбросаны в рандомных местах
3) все собственные сервисы давным давно легли
4) не осуждайте авторов-дебилов за использование exec(), они ничего не знали
5) да-да-да. бот синхронный. только если оно захлебнётся запросами, это уже не совсем проблема авторов бота
6) для графического софта требуется Pillow==9.4.0. да, вот такой миленький костыль, без которого ничего не работает
7) почему в корне куча каких то txt файлов? авторы дебилы забыли выпилить древний костыль
8) для работы требуется ещё и юзеракк (наверное)
9) база данных на папках и txt файлах. там хранятся юзеры, чаты и ещё чёта
10) оба разработчика херово разбираются в коде (особенно обработчика событий)
11) в сурсах куча всякой кринжовой отсебятины и незадокументированного софта бота
12) доков не будет или напишите сами
13) вк_апи. да, да, да. всё хотели СВОЮ ИННОВАЦИОННУЮ БИБЛИОТЕКУ для вк сделать, да чёт ноги не дошли((
14) фастстарт умеет сам устанавливать модули. если повезёт то они реально установятся
15) названия переменных в коде = своеобразный кошмар
16) бот матюкается (ну он же молодёжкой написан)
17) как то раз автор не зная что линукс умеет кешировать файлы, и написал своё кеширование файлов. ну ладно, это прибавляет производительности на системах Windows NT.
18) бот не работает без лишних пинков на Windows NT
19) на Darwin, BSD, прочих платформах кроме Linux x86_64 GLIBC вообще не тестировался
20) для запуска требуется Python 3.10 как минимум (если не 3.11 из за каких то там костылей)
21) всё время разработки (2020-2021) разрабы думали что никогда не откроют свой код
22) для того чтобы полностью понимать всё это дерьмо нужен групповой разум
23) memgun - пушка памяти - своеобразный ужас (дамп переменных в html-экспорт, отслеживание изменений 0_о) дебаггеры нервно курят в сторонке
24) самый лучший способ запустить бота - создать для него отдельную юзерку в системе с названием catpy. речь о линукс-подобных системах
25) на musl, uclibc и прочих библиотеках C кроме GLIBC вообще не тестировался
26) половина модулей которые он качает больше не нужны и вообще депрекейтед
27) в обработчике событий много чего не работает
28) зачем юзеракк для работы ? не помню зачем но инициализируется объект vk2 для каких то фич ВК, которые дёргаются только от юзерки
29) betabot.py предназначен для паблика catpy beta-testers. программа бета-тестирования кетпая давным давно мертва
30) в 2020, 2021 авторы знать не знали почему sql лучше баз на txt
31) куча костылей свойственных только для POSIX-систем. к примеру вызов stty size функциями логирования
32) с собственных сервисов (catwareai.ctw.re, artificalintellect.pythonanywhere.com) аннулированы все токены, даже не пытайтесь
33) скорее всего сурсов catwareai.ctw.re и artificalintellect.pythonanywhere.com; catwareai.pythonanywhere.com НЕ БУДЕТ.
34) последние вмешательства в код - различные правки чтобы бот ну ваще типо не умирал полностью, его работоспособность поддерживалась периодически на протяжении 2х лет. это мы называем CatABMS LTS
35) если подождать пока стартанёт обработчик событий ("CatABMS Kernel") и нажать ^C, то вы попадете в своеобразный шелл, где можно сделать дамп и ещё много чего (см. папку exf)
36) по поводу отсебятины в коде - это ещё цветочки, много чего было подчищено
37) пожалуйста, если надумаете сделать добровольный рефактор или форк, то Я не ручаюсь за ваше психоэмоциональное состояние. у меня нет денег чтобы оплачивать Вам лечение в психиатрической больнице
38) CUMv2 - Catware User Manager, а не то, что Вы могли подумать
39) я сам не знаю (точнее не помню) что такое ASCAPI
40) я сам не помню 90% функций CatENV (документация по нему давным давно утеряна)
41) да, там несколько групп функций для логирования. автор как всегда гений пытался сделать как можно пафоснее но в итоге абасрался
42) сурсы не пытаются оскорбить кого то / задеть чьи то чувства. если вы увидели в сурсах что то оскорбительное в свой адрес, пожалуйста, не обижайтесь. мы не специально
43) сурсы не призывают к экстремизму. АУЕ признана экстремистской в Российской Федерации
44) если защитник Windows думает что вы скачали вирусню, то просто избавьтесь от sralker.py. он думает что это кейлоггер, хотя там просто использован PEPовский модуль pynput.
45) start.py = deprecated, актуальным загрузчиком является faststart.py
46) не такой уж он и fast. отличался только тем что не спрашивает юзеринпут при запуске бота, поэтому и "fast"
47) если вы где то увидели токен то пожалуйста не думайте что вы сможете им воспользоваться. всё давным давно аннулировано
48) половина файлов в корневом каталоге вообще не относятся к самому боту. вообще изначально бот разрабатывался как тестовый полигон
49) "шапки" команд в файлах commands/*/*.py неактуальны с версии 0.9_53. не обращайте внимания...(
50) ещё много чего, мне уже лень вспоминать чё там да как. вообщем, дерзайте!

## исторические моменты этого говнокода
1) разработка по сути своей вообще началась не в 2020 году, а в 2018-2019. по сути, это в свою очередь рефактор ещё более ужасного кода
2) по сути, разрабатывался как полигон для того чтобы я сразу имел какую то практику в процессе изучения языка Python. практика такая себе, как можете заметить
3) сейчас я уже не допущу большинства моментов допущенных в коде. правда у меня всё равно довольно тупая привычка совать exec() куда попало.
4) язык конфигурации. я ничего не придумал лучше, как читать файлы и пихать их опять же в exec(). это очень прикольно, но неправильно. в идеале вообще использовать YAML, но я не хочу тянуть отдельный модуль ради того чтобы ПРОЧИТАТЬ КОНФИГУРАЦИОННЫЙ ФАЙЛ.
5) плевать я хотел на путаницу имён и пространств имён, когда я писал этот "гениальный" код, я вообще не имел никакого представления обо всём. я просто знал, что переменные можно обзывать
6) изначально бот должен был быть многопоточным (это я так придумал) - просто совать в отдельный поток выполнение каждой команды. но опять же, тогда я не осилил пространства имён, а когда излагал идею многопоточности, вовсе сталкивался с критикой, мол многопоточность в данном случае сделает плохо (мол линупс своей персоной отправит мне -9 из за того что программа заспавнит слишком много потоков. Ничего не знаю, кроме того, что в питоне имеется GIL (Global Interpreter Lock), которая каким-то образом (да, я до сих пор не изучил) мешает многопоточности.
7) была идея переписать бота на C/C++. такая себе идея, сами понимаете
8) по поводу многопоточности - предлагали переписать бота на vkwave или vkbottle, чтобы самому не надо было осиливать асинхронность и её азы. но я в свою очередь забил и просто продолжил писать синхронного бота под vk_api. также лично мне не нравится допустим тот же vkbottle, смотря на то, как гениально там реализована документация - мол, скачайте себе крутое ИДЕ и смотрите на названия функций. БРАВО
9) ООП. моя больная тема, я никогда не понимал, зачем оно нужно и что оно мне даст. до сих пор не вижу в нём смысла, считаю не нужно лишне нагромождать какую-то систематизацию. попытки Хауди Хо обьяснить мне что такое инкапсуляция и прочие принципы ООП, грандиозно провалились. (про хамуди хо рофл, я не воспринимаю его всерьёз с его видосами а-ля учим Python за 1 час)
10) потом я просто потерял всякий энтузиазм к разработке этого продукта и мне уже было до лампочки, что и как писать. проект не приносил никакой прибыли кроме донатов, говоря кстати
11) по сути я запостил почищенные сурсы, а так в них было ещё очень много разной отсебятины, также я чуть ли не по крупице чистил сурсы от токенов, потому что они буквально разбросаны где попало. в файлах команд, в конфигурационных файлах, в обработчике событий, в каких-то отдельных файлах. МДА
12) изначально план опенсорса планировался следующим образом: мы постим максимально урезанную версию CatABMS под названием CatABMS-studio. чтобы разработчики могли независимо пилить свои команды, но в итоге даже страница на wiki привлекла только одного единственного стороннего разработчика. и то, тот пользовался функционалом CatENV вообще неправильно
13) изначально хостились на pythonanywhere со стабильными падениями каждые 3 дня. потом переехали к Антону, потом к Антону на виртуалку, потом на VDS от Timeweb (промо-виртуалка за 45 рублей в месяц - 512 метров ОЗУ, одно виртуальное ядро, 5 ГБ на диске, 5 мб/с пропускной канал ) ))  )) ) . Изначально работали под управлением CentOS 7 (исходя из привычки, так было у Антона)
14) пока сидели у Антона, почему-то кетпай именно у него валился с ошибкой Can't allocate memory. проблема сама собой пофиксилась с переездом на таймвеб
15) когда то хватило мозгов оформить рекурсию где то между функций катенва, поэтому кетпай валился на старте с ошибкой recursion limit exceeded.
16) раньше были шапки команд. теперь просто json-файлы рядом с .py файлами в субдиректории commands/. нам было лень чистить эти "шапки", так что да
17) была попытка сделать вторую версию, но она провалилась, так как я пилил её в состоянии утренней мотивации (да, да, так и было) и уснул к черту. забыл на следующий день о ней как о страшном сне. проект назывался ABMS2 (без префикса Cat). впрочем-то по качеству кода он недалеко уехал от своего "предшественника"


## интересные факты
1) /утил выключить устанавливает конский лимит рекурсии через sys; вызывает рекурсивную функцию вызывающую саму себя и валится в сегфолт
2) разработчики малолетние дебилы недавно окончившие 7-8 класс (это актуально для 2021 года - год, летом которого оба разраба сговорились больше ничё не девелопить)
3) изначально проект назывался не "catpy", а "izzytop". да, главный автор слишком сильно уважал ютубера Izzy Laif, что решил назвать бота в честь него.
4) бот как то случайно получил освящение на странице изи, после чего к проекту (((по сути присоединился))) Никита Полищук - ныне элита нашей тусовки
5) тусовка постепенно образовалась в 2021 году. все кто были там, сейчас являются элитой среди остальных. да, за нашей спиной не только кетпай
6) как было принято решение о завершении разработки? мы с агриком решили, что кетпай и вообще боты вконтакте - пройденный этап, и пора заняться разработкой Web-сервисов и практикой инфраструктуры. этим и занялись в дальнейшем
7) если вам в падлу подсчитывать, то тут в общей сложности 7580 строчек кода. так то их больше, ибо сурсы были чуток очищены. 988 КБ .py файлов

*продолжение следует (наверное)*
